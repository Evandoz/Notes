<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Gitment 解决 Validation Failed 问题 | EXP Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="author" content="Levan">
  
  
    <meta name="description" content="日常记录与分享">
  
  
    <meta name="keywords" content="Hexo,gitment初始化失败,Validation Failed">
  
  
    <meta name="google-site-verification" content="W2AVg5n_ALo21rl9n3ZwS8AuEanZfJkirzrRGLLYvn4">
  
  
    <meta name="baidu-site-verification" content="BM2Q3xLpPJ">
  
  
    <meta name="360-site-verification" content="573211edf2de02c99d7b255b2c56513c">
  
  
    <link rel="short icon" type="image/x-icon" href="/Notes/css/images/favicon.ico">
  
  <link rel="canonical" href="https://evandoz.github.io/Notes/archives/1c689d769175.html">
  
<link rel="stylesheet" href="/Notes/css/style.css">

<meta name="generator" content="Hexo 5.3.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="overflow" class="overflow">
    <div id="hiddenbar" class="hiddenbar">
      <div id="wrapper" class="wrapper">
        <header id="header" class="header is-post">
  <div class="outer">
    <div class="logo">
      <a class="title" href="/Notes/">EXP Notes</a>
    </div>
    <div class="nav">
      <ul id="nav-icon" class="nav-icon">
        <li></li><li></li><li></li>
      </ul>
      <ul class="nav-menu">
        
          <li class="nav-item">
            <a href="/Notes/archives">归档</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/categories">分类</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/tags">标签</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/about">关于</a>
          </li>
        
      </ul>
    </div>

  </div>
</header>

        <div id="content" class="content">
    <section class="article-header inner">
      <img src="/Notes/css/images/banner2.jpg" alt="banner">
      

      
  
  	<h1 class="post-title">Gitment 解决 Validation Failed 问题</h1>
  


      <div class="post-meta">
        <span class="post-date">
  <time datetime="2018-01-24T16:00:00.000Z">2018-01-25</time>
</span>

        
  <span class="post-category">
    <a class="category-link" href="/Notes/categories/Hexo/">Hexo</a>
  </span>


      </div>
    </section>
    <section class="article-body inner">
      <div id="side" class="aside post left">

      </div>
      <div class="main">
        <article id="Hexo/20180125-Gitment 解决 Validation Failed 问题" class="article">
          <div id="post-content" class="post-content">
            <p>尝试使用gitment评论系统过程中，配置完成后初始化评论出现验证失败问题(Error: Validation Failed)。</p>
<a id="more"></a>
<h2 id="问题出现"><a class="headerlink" href="#问题出现"></a>问题出现</h2>
<p>第一次配置 gitment 时，按照官方文档进行如下设置：</p>
<pre class="line-numbers language-none"><code class="language-none">const gitment &#x3D; new Gitment(&#123;
  id: &#39;Your page ID&#39;, &#x2F;&#x2F; optional
  owner: &#39;Your GitHub ID&#39;,
  repo: &#39;The repo to store comments&#39;,
  oauth: &#123;
    client_id: &#39;Your client ID&#39;,
    client_secret: &#39;Your client secret&#39;,
  &#125;,
  &#x2F;&#x2F; ...
  &#x2F;&#x2F; For more available options, check out the documentation below
&#125;)

gitment.render(&#39;comments&#39;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>由于 id 这一项，默认为 window.location.pathname ，于是便删除了这一条。随后 push 到 github，初始化评论(Initialize Comments)时，浏览器边弹窗报错：</p>
<pre class="line-numbers language-none"><code class="language-none">Error: Validation Failed<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="问题解决"><a class="headerlink" href="#问题解决"></a>问题解决</h2>
<p>经过一番摸索，疑似是因为 gitment 配置中 id 过长引起的。因为 gitment 是其作者基于 gitHub 的 issue 开发的，每一条 issue 会有两个 label，label 的最大长度限制为50个字符。这个问题多数人都遇到过，关于这个问题的讨论与建议在 gitment 的 issues 上出现过：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/imsun/gitment/issues/116">Validation Failed ID长度问题建议</a>，印证了前面的想法。问题找到了，那么我们设置一个长度较短的 id 就可以了。</p>
<p>起初想用 page.title 来作为 id，然而操作并不顺利，因为我的标题大部分是中文，而且长度也都不短，再通过 utf 转码会有一堆 % 占空间，长度必定更长。</p>
<p>最后决定使用 page.path 作为 id，因为我的 permalink 的配置有所更改，所以 page.path 的长度相对较短，重新设置后初始化成功，Initialize Comments 按钮变成了文字 No Comment Yet 。</p>
<p>关于我的 permalink 设置(在博客根目录的 config.yml 中)，只保留了 year 和 title：</p>
<pre class="line-numbers language-none"><code class="language-none">xxx
permalink: :year&#x2F;:title&#x2F;
xxx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="最后"><a class="headerlink" href="#最后"></a>最后</h2>
<p>由于我的 page.path 长度在50个字符以内，所以上述的设置能够成功。但这并不适合所有情况，具体情况具体分析，只要保证 id 在50个字符以内即可。</p>

          </div>
          <div class="post-footer">
            <div class="post-copyright">&copy; 除特殊声明外，文章著作权归作者所有，转载请注明作者及出处</div>
          </div>
        </article>
        <!-- Pagination -->
        
          <div class="nagination card">
            
              <a href="/Notes/archives/8ca994e41df6" class="nagination-link">上篇: Vue Router+Element UI 实现导航实例</a>
            
            
              <a href="/Notes/archives/aadca65a381b" class="nagination-link">下篇: 计算机系统中的字长</a>
            
          </div>
        
        <!-- Comment -->
        <!-- 
          <div id="article-comment" class="article-comment card"></div>

         -->
      </div>
      <div id="toc" class="toc">
        
          <ol class="toc-content"><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E9%97%AE%E9%A2%98%E5%87%BA%E7%8E%B0"><span class="toc-content-text">问题出现</span></a></li><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="toc-content-text">问题解决</span></a></li><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-content-text">最后</span></a></li></ol>
        
      </div>
    </section>


</div>
        <footer id="footer" class="footer">
  <div class="outer">
    <div class="copyright">
      <p><span>EXP Notes</span> &copy; 2015 - 2022</p>
    </div>
    <div class="navigation">
      <a href="https://evandoz.github.io">Hexo · Levan</a>
    </div>
  </div>
</footer>

      </div>
    </div>
  </div>
  
  <div id="mobile-nav" class="mobile-nav">
  
    <a class="menu-item" href="/Notes/archives">归档</a>
  
    <a class="menu-item" href="/Notes/categories">分类</a>
  
    <a class="menu-item" href="/Notes/tags">标签</a>
  
    <a class="menu-item" href="/Notes/about">关于</a>
  
</div>

<div id="over-layer" class="over-layer"></div>

  
<script src="/Notes/js/jquery.js"></script>


<script src="/Notes/js/velocity.js"></script>


<script src="/Notes/js/plugins.js"></script>


<script src="/Notes/js/script.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->




</body>
</html>
