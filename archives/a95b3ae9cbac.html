<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>表达式求值 | EXP Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="author" content="Levan">
  
  
    <meta name="description" content="日常记录与分享">
  
  
    <meta name="keywords" content="数据结构,栈的经典应用,表达式求值">
  
  
    <meta name="google-site-verification" content="W2AVg5n_ALo21rl9n3ZwS8AuEanZfJkirzrRGLLYvn4">
  
  
    <meta name="baidu-site-verification" content="BM2Q3xLpPJ">
  
  
    <meta name="360-site-verification" content="573211edf2de02c99d7b255b2c56513c">
  
  
    <link rel="short icon" type="image/x-icon" href="/Notes/css/images/favicon.ico">
  
  <link rel="canonical" href="https://evandoz.github.io/Notes/archives/a95b3ae9cbac.html">
  
<link rel="stylesheet" href="/Notes/css/style.css">

<meta name="generator" content="Hexo 5.3.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="overflow" class="overflow">
    <div id="hiddenbar" class="hiddenbar">
      <div id="wrapper" class="wrapper">
        <header id="header" class="header is-post">
  <div class="outer">
    <div class="logo">
      <a class="title" href="/Notes/">EXP Notes</a>
    </div>
    <div class="nav">
      <ul id="nav-icon" class="nav-icon">
        <li></li><li></li><li></li>
      </ul>
      <ul class="nav-menu">
        
          <li class="nav-item">
            <a href="/Notes/archives">归档</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/categories">分类</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/tags">标签</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/about">关于</a>
          </li>
        
      </ul>
    </div>

  </div>
</header>

        <div id="content" class="content">
    <section class="article-header inner">
      <img src="/Notes/css/images/banner2.jpg" alt="banner">
      

      
  
  	<h1 class="post-title">表达式求值</h1>
  


      <div class="post-meta">
        <span class="post-date">
  <time datetime="2016-04-12T16:00:00.000Z">2016-04-13</time>
</span>

        
  <span class="post-category">
    <a class="category-link" href="/Notes/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a> · <a class="category-link" href="/Notes/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%A0%88%E4%B8%8E%E9%98%9F%E5%88%97/">栈与队列</a>
  </span>


      </div>
    </section>
    <section class="article-body inner">
      <div id="side" class="aside post left">

      </div>
      <div class="main">
        <article id="数据结构/栈与队列/20160413-表达式求值" class="article">
          <div id="post-content" class="post-content">
            <p>表达式求值是程序设计语言编译中一个最基本问题，它的实现是栈应用的一个经典例子。</p>
<h2 id="两种表达式"><a class="headerlink" href="#两种表达式"></a>两种表达式</h2>
<p>中缀表达式不仅依赖运算符优先级，还要处理括号的问题。</p>
<p>后缀表达式中运算符在操作数后面，表达式中已经考虑了运算符的优先级，没有括号的干扰，只有操作数和运算符。</p>
<p>通过后缀表达式来计算结果相对简单：</p>
<p>顺序扫描表达式每一项，若该项为操作数则压入栈；若该项为运算符，则连续从栈中退出两个操作数，通过运算符进行运算，并将结果压入栈中。<br>
当表达式处理完成时，栈中存放的即为结果。</p>
<h2 id="代码实现"><a class="headerlink" href="#代码实现"></a>代码实现</h2>
<p>先将中缀表达式转化为后缀表达式，然后进行计算。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>

using namespace std<span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">MAXSIZE</span> <span class="token expression"><span class="token number">100</span></span></span>

<span class="token comment">//栈的数据结构</span>
<span class="token keyword">typedef</span> <span class="token keyword">struct</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> data<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> top<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>Stack<span class="token punctuation">;</span>

<span class="token comment">// 运算符优先级数组</span>
<span class="token comment">//              45 91 47 93 40 41 42 43</span>
<span class="token comment">//              -  [  /  ]  (  )  *  +</span>
<span class="token comment">//          %9  0  1  2  3  4  5  6  7</span>
<span class="token keyword">int</span> table<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token comment">//初始化栈空间</span>
<span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>Stack <span class="token operator">*</span>sta<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> MAXSIZE<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
        sta<span class="token operator">-></span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    sta<span class="token operator">-></span>top <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 中缀表达式(infix)转后缀表达式(suffix)，返回值为后缀表达式数组长度</span>
<span class="token comment">// 因为数字和运算符都当作 int 存储，为了区分，op 用于标识哪些元素是运算符(1)，哪些是运算量(0)</span>
<span class="token keyword">int</span> <span class="token function">infix_to_suffix</span><span class="token punctuation">(</span>Stack <span class="token operator">*</span>sta<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>infix<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>suffix<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>op<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 循环变量</span>
    <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 当数字是十位或以上的时候进行记录</span>
    <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// suffix数组的下标</span>
    <span class="token keyword">int</span> priority <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 记录栈顶元素的优先级</span>

    <span class="token comment">// for循环的第三表达式不进行i++，将其放在每一次的压栈后或直接输出到suffix进行i++</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>infix<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">// 如果是数字的话，直接放在suffix中,然后continue</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token char">'0'</span> <span class="token operator">&amp;&amp;</span> infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token char">'9'</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token comment">// 恢复打散的数码</span>
            b<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 每次重新赋值为零</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token char">'0'</span> <span class="token operator">&amp;&amp;</span> infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token char">'9'</span><span class="token punctuation">)</span>
                b<span class="token operator">=</span>b <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span>infix<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            suffix<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 如果是右中括号的话，栈中在左中括号以上的所有运算符出栈，然后continue</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">93</span><span class="token punctuation">)</span> <span class="token comment">// ]</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">91</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                suffix<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>
                sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            priority <span class="token operator">=</span> table<span class="token punctuation">[</span>sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token operator">++</span>i<span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 如果是右括号的话，栈中在左括号以上的所有运算符出栈，然后continue</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">41</span><span class="token punctuation">)</span> <span class="token comment">// )</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">40</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                suffix<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>
                sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            priority <span class="token operator">=</span> table<span class="token punctuation">[</span>sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token operator">++</span>i<span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 如果是左(中)括号的话，直接压栈</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">40</span> <span class="token operator">||</span> infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">91</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            sta<span class="token operator">-></span>data<span class="token punctuation">[</span><span class="token operator">++</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> infix<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            priority <span class="token operator">=</span> table<span class="token punctuation">[</span>sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 如果只是普通的运算符，则压栈</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">42</span> <span class="token operator">&amp;&amp;</span> infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">47</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token comment">// 当栈顶运算符优先级大于待入栈运算符优先级时，栈顶元素依次出栈</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>sta<span class="token operator">-></span>top <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> priority <span class="token operator">>=</span> table<span class="token punctuation">[</span>infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                <span class="token keyword">while</span><span class="token punctuation">(</span>sta<span class="token operator">-></span>top <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> priority <span class="token operator">>=</span> table<span class="token punctuation">[</span>infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">40</span> <span class="token operator">&amp;&amp;</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token number">91</span><span class="token punctuation">)</span>
                <span class="token punctuation">&#123;</span>
                    op<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 【重要】标记为运算符</span>
                    suffix<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>
                    sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    priority <span class="token operator">=</span> table<span class="token punctuation">[</span>sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
                sta<span class="token operator">-></span>data<span class="token punctuation">[</span><span class="token operator">++</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> infix<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                priority <span class="token operator">=</span> table<span class="token punctuation">[</span>sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span>
            <span class="token punctuation">&#123;</span>
                <span class="token comment">// 处理负数的提取 (-x)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>infix<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">45</span> <span class="token operator">&amp;&amp;</span> infix<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">40</span> <span class="token operator">&amp;&amp;</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">40</span><span class="token punctuation">)</span>
                <span class="token punctuation">&#123;</span>
                    b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    <span class="token keyword">while</span> <span class="token punctuation">(</span>infix<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token char">'0'</span> <span class="token operator">&amp;&amp;</span> infix<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token char">'9'</span><span class="token punctuation">)</span>
                    <span class="token punctuation">&#123;</span>
                        b <span class="token operator">=</span> b <span class="token operator">*</span> <span class="token number">10</span> <span class="token operator">+</span> <span class="token punctuation">(</span>infix<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token char">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token operator">++</span>i<span class="token punctuation">;</span>
                    <span class="token punctuation">&#125;</span>
                    suffix<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> b <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
                    i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">// )</span>
                    priority <span class="token operator">=</span> table<span class="token punctuation">[</span>sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                    <span class="token keyword">continue</span><span class="token punctuation">;</span>
                <span class="token punctuation">&#125;</span>
                sta<span class="token operator">-></span>data<span class="token punctuation">[</span><span class="token operator">++</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> infix<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                priority <span class="token operator">=</span> table<span class="token punctuation">[</span>sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token operator">%</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// 栈中剩余的元素出栈</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>sta<span class="token operator">-></span>top <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        op<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 【重要】标记为运算符</span>
        suffix<span class="token punctuation">[</span>j<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token operator">--</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> j<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// 后缀表达式(suffix)转为结果(result)，返回值即为计算结果</span>
<span class="token comment">// 循环遍历后缀表达式，数字就直接压栈，运算符就取栈顶两个元素出来计算，并将结果重新压栈，栈中最后就是结果</span>
<span class="token keyword">int</span> <span class="token function">suffix_to_result</span><span class="token punctuation">(</span>Stack <span class="token operator">*</span>sta<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>suffix<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>op<span class="token punctuation">,</span> <span class="token keyword">int</span> length<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>op<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">switch</span><span class="token punctuation">(</span>suffix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
            <span class="token keyword">case</span> <span class="token number">42</span><span class="token operator">:</span> <span class="token comment">// *</span>
                result <span class="token operator">=</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>
                sta<span class="token operator">-></span>data<span class="token punctuation">[</span><span class="token operator">--</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">43</span><span class="token operator">:</span> <span class="token comment">// +</span>
                result <span class="token operator">=</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>
                sta<span class="token operator">-></span>data<span class="token punctuation">[</span><span class="token operator">--</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">45</span><span class="token operator">:</span> <span class="token comment">// -</span>
                result <span class="token operator">=</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>
                sta<span class="token operator">-></span>data<span class="token punctuation">[</span><span class="token operator">--</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token number">47</span><span class="token operator">:</span> <span class="token comment">// /</span>
                result <span class="token operator">=</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> sta<span class="token operator">-></span>data<span class="token punctuation">[</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span><span class="token punctuation">;</span>
                sta<span class="token operator">-></span>data<span class="token punctuation">[</span><span class="token operator">--</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> result<span class="token punctuation">;</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span>
        <span class="token punctuation">&#123;</span>
            sta<span class="token operator">-></span>data<span class="token punctuation">[</span><span class="token operator">++</span>sta<span class="token operator">-></span>top<span class="token punctuation">]</span> <span class="token operator">=</span> suffix<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    Stack sta<span class="token punctuation">;</span>
    <span class="token keyword">int</span> length<span class="token punctuation">,</span> result<span class="token punctuation">;</span> <span class="token comment">// 后缀表达式长度，运算结果</span>
    <span class="token keyword">char</span> istr<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 中缀表达式</span>
    <span class="token keyword">int</span> op<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span> sstr<span class="token punctuation">[</span>MAXSIZE<span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token comment">// 运算符标记，后缀表达式</span>

    cout<span class="token operator">&lt;&lt;</span><span class="token string">"Input expression:"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    cin<span class="token operator">>></span>istr<span class="token punctuation">;</span>

    <span class="token function">init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sta<span class="token punctuation">)</span><span class="token punctuation">;</span>
    length <span class="token operator">=</span> <span class="token function">infix_to_suffix</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sta<span class="token punctuation">,</span> istr<span class="token punctuation">,</span> sstr<span class="token punctuation">,</span> op<span class="token punctuation">)</span><span class="token punctuation">;</span>

    cout<span class="token operator">&lt;&lt;</span><span class="token string">"Suffix expression:"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>op<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> cout<span class="token operator">&lt;&lt;</span><span class="token keyword">char</span><span class="token punctuation">(</span>sstr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span><span class="token string">"  "</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> cout<span class="token operator">&lt;&lt;</span>sstr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">&lt;&lt;</span><span class="token string">"  "</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    cout<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token function">init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sta<span class="token punctuation">)</span><span class="token punctuation">;</span>
    result <span class="token operator">=</span> <span class="token function">suffix_to_result</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>sta<span class="token punctuation">,</span> sstr<span class="token punctuation">,</span> op<span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">;</span>

    cout<span class="token operator">&lt;&lt;</span><span class="token string">"Result of expression:"</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span>istr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
        cout<span class="token operator">&lt;&lt;</span>istr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    cout<span class="token operator">&lt;&lt;</span><span class="token string">"="</span><span class="token operator">&lt;&lt;</span>result<span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>DONE！</strong></p>

          </div>
          <div class="post-footer">
            <div class="post-copyright">&copy; 除特殊声明外，文章著作权归作者所有，转载请注明作者及出处</div>
          </div>
        </article>
        <!-- Pagination -->
        
          <div class="nagination card">
            
              <a href="/Notes/archives/73201214c3d5" class="nagination-link">上篇: 顺序队列与链队列的实现</a>
            
            
              <a href="/Notes/archives/7bc32dd9cc9e" class="nagination-link">下篇: 长整数相加</a>
            
          </div>
        
        <!-- Comment -->
        <!-- 
          <div id="article-comment" class="article-comment card"></div>

         -->
      </div>
      <div id="toc" class="toc">
        
          <ol class="toc-content"><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E4%B8%A4%E7%A7%8D%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-content-text">两种表达式</span></a></li><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-content-text">代码实现</span></a></li></ol>
        
      </div>
    </section>


</div>
        <footer id="footer" class="footer">
  <div class="outer">
    <div class="copyright">
      <p><span>EXP Notes</span> &copy; 2015 - 2022</p>
    </div>
    <div class="navigation">
      <a href="https://evandoz.github.io">Hexo · Levan</a>
    </div>
  </div>
</footer>

      </div>
    </div>
  </div>
  
  <div id="mobile-nav" class="mobile-nav">
  
    <a class="menu-item" href="/Notes/archives">归档</a>
  
    <a class="menu-item" href="/Notes/categories">分类</a>
  
    <a class="menu-item" href="/Notes/tags">标签</a>
  
    <a class="menu-item" href="/Notes/about">关于</a>
  
</div>

<div id="over-layer" class="over-layer"></div>

  
<script src="/Notes/js/jquery.js"></script>


<script src="/Notes/js/velocity.js"></script>


<script src="/Notes/js/plugins.js"></script>


<script src="/Notes/js/script.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->




</body>
</html>
