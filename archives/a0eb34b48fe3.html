<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>插入排序（二） | EXP Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="author" content="Levan">
  
  
    <meta name="description" content="日常记录与分享">
  
  
    <meta name="keywords" content="插入排序,希尔排序">
  
  
    <meta name="google-site-verification" content="W2AVg5n_ALo21rl9n3ZwS8AuEanZfJkirzrRGLLYvn4">
  
  
    <meta name="baidu-site-verification" content="BM2Q3xLpPJ">
  
  
    <meta name="360-site-verification" content="573211edf2de02c99d7b255b2c56513c">
  
  
    <link rel="short icon" type="image/x-icon" href="/Notes/css/images/favicon.ico">
  
  <link rel="canonical" href="https://evandoz.github.io/Notes/archives/a0eb34b48fe3.html">
  
<link rel="stylesheet" href="/Notes/css/style.css">

<meta name="generator" content="Hexo 5.3.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="overflow" class="overflow">
    <div id="hiddenbar" class="hiddenbar">
      <div id="wrapper" class="wrapper">
        <header id="header" class="header is-post">
  <div class="outer">
    <div class="logo">
      <a class="title" href="/Notes/">EXP Notes</a>
    </div>
    <div class="nav">
      <ul id="nav-icon" class="nav-icon">
        <li></li><li></li><li></li>
      </ul>
      <ul class="nav-menu">
        
          <li class="nav-item">
            <a href="/Notes/archives">归档</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/categories">分类</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/tags">标签</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/about">关于</a>
          </li>
        
      </ul>
    </div>

  </div>
</header>

        <div id="content" class="content">
    <section class="article-header inner">
      <img src="/Notes/css/images/banner2.jpg" alt="banner">
      

      
  
  	<h1 class="post-title">插入排序（二）</h1>
  


      <div class="post-meta">
        <span class="post-date">
  <time datetime="2016-09-08T16:00:00.000Z">2016-09-09</time>
</span>

        
  <span class="post-category">
    <a class="category-link" href="/Notes/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a> · <a class="category-link" href="/Notes/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8E%92%E5%BA%8F/">排序</a>
  </span>


      </div>
    </section>
    <section class="article-body inner">
      <div id="side" class="aside post left">

      </div>
      <div class="main">
        <article id="数据结构/排序/20160909-插入排序（二）" class="article">
          <div id="post-content" class="post-content">
            <h2 id="2-路插入排序（2-Path-Insertion-Sort）"><a class="headerlink" href="#2-路插入排序（2-Path-Insertion-Sort）"></a>2-路插入排序（2-Path Insertion Sort）</h2>
<h3 id="基本思想"><a class="headerlink" href="#基本思想"></a>基本思想</h3>
<p>2-路插入排序是在折半插入排序的基础上再改造，其目的是减少排序过程中移动元素的次数，但是为此需要 n 个记录的辅助空间</p>
<p>具体地，另设一个和 L（的关键字）同类型的数组 d，将 L[1] 赋值给 d[1]，并将 d[1] 看成是在排好序的序列中<strong>处于中间位置</strong>的元素（中轴），然后依次将待排序列 L[2…n] 依次插入到 d[1] 之前或之后的有序序列中，即比 d[1] 小的插入到前面，比 d[1] 大的插入到后面。排序完成后，将 d[] 中有序序列回填到 L 中，并释放放 d。</p>
<p>要点：算法实现时，可将 d[] 看成一个循环向量，并设置两个指针 first 和 final 分别指向排序进行时已得到的有序序列中<strong>第一个元素</strong>和<strong>最后一个元素</strong>在 d[] 中的位置。</p>
<h3 id="代码实现"><a class="headerlink" href="#代码实现"></a>代码实现</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">TwoInsertSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> L<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> first <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> last <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 初始化首尾指针</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>tmpbuffer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>n <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> tmpbuffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    tmpbuffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// tmpbuffer[0]为中轴</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> tmpbuffer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 右插，保证稳定大于时取等</span>
        <span class="token punctuation">&#123;</span>
            <span class="token comment">// 首次运行到这时，循环不会执行</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> last<span class="token punctuation">;</span> L<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> tmpbuffer<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">--</span>j<span class="token punctuation">)</span>
                tmpbuffer<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmpbuffer<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 从last开始，比较查找，向后移动</span>
            tmpbuffer<span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> last <span class="token operator">=</span> last <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token comment">// 左插</span>
        <span class="token punctuation">&#123;</span>
            <span class="token comment">// 首次运行到这时，循环不会执行，</span>
            <span class="token comment">// 之后，first 指针将移动到数组尾部 d[n-1]不需要管j会不会越界</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> first<span class="token punctuation">;</span> L<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> tmpbuffer<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span>
                tmpbuffer<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> tmpbuffer<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 从first开始，比较查找，向前移动</span>
            <span class="token comment">// 首次运行到这时，first 指针将移动到数组尾部 d[n-1]，此时需要取余，之后不需要</span>
            tmpbuffer<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token operator">+</span>n<span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> first <span class="token operator">=</span> <span class="token punctuation">(</span>first <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// 回填 L</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
        L<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmpbuffer<span class="token punctuation">[</span><span class="token punctuation">(</span>first<span class="token operator">++</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// first 为有序序列头指针</span>
    <span class="token function">free</span><span class="token punctuation">(</span>tmpbuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="归纳分析"><a class="headerlink" href="#归纳分析"></a>归纳分析</h3>
<ol>
<li>稳定排序（stable sort）</li>
</ol>
<p>针对折半插入排序的优化，减少移动次数，仍是稳定排序。</p>
<ol start="2">
<li>空间复杂度（out-of-place 非原地算法，O(n)）</li>
</ol>
<p>需要另辟 n 空间辅助排序，排序完成后需要回填数据，空间复杂度为 O(n)</p>
<ol start="3">
<li>时间复杂度</li>
</ol>
<p>比较和移动操作一块进行；</p>
<p>排序中，移动元素次数约为 n<sup>2</sup>/8，2-路插入排序只能减少移动元素的次数，不能绝对避免移动，并且当当待排序列首元素 L[1] （被选为中轴）是序列中最小或最大时，2-路插入排序将完全失去优越性，因此，2-路插入排序时间复杂度 <strong>与初始状态有关</strong>。</p>
<p>当然，在选择中轴元素时，不一定非要选择首元素，可随机选择首元素尽可能避免这种问题。</p>
<p><strong>平均</strong>情况下，2-路插入排序时间复杂度为 O(n<sup>2</sup>)。</p>
<ol start="4">
<li>初态影响</li>
</ol>
<p>仍然是插入排序，受初始状态影响。</p>
<ol start="5">
<li>过程特征</li>
</ol>
<p>一趟排序不能确定一个元素的最终位置，但会产生<strong>局部有序</strong>的有序子序列。</p>
<ol start="6">
<li>适用性</li>
</ol>
<p>仍然是插入排序，比较适合用于“基本有序”的序列和“数据量不大”的序列。</p>
<h3 id="扩展"><a class="headerlink" href="#扩展"></a>扩展</h3>
<p>既有中轴，又有头尾指针，显得有些冗余，取消中轴，由首尾指针将序列分成三部分，进行3路插入，相当于两个中轴，代码实现如下：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">ThreeInsertSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> L<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token comment">// 这个其实是3路，跟first和last比较，待排序列被first和last分成了三部分</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> first <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> last <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 初始化首尾指针</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>tmpbuffer <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>n <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> tmpbuffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> tmpbuffer<span class="token punctuation">[</span>last<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 保证稳定大于时取等</span>
        <span class="token punctuation">&#123;</span>
            last <span class="token operator">=</span> last <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            tmpbuffer<span class="token punctuation">[</span>last<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>L<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> tmpbuffer<span class="token punctuation">[</span>first<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 小于时不取等</span>
        <span class="token punctuation">&#123;</span>
            first <span class="token operator">=</span> <span class="token punctuation">(</span>first<span class="token operator">-</span><span class="token number">1</span><span class="token operator">+</span>n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">;</span>
            tmpbuffer<span class="token punctuation">[</span>first<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token comment">// 中间这部分仍是简单插入排序</span>
        <span class="token punctuation">&#123;</span>
            j <span class="token operator">=</span> last<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span>L<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> tmpbuffer<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                tmpbuffer<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> tmpbuffer<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
                j <span class="token operator">=</span> <span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token operator">+</span>n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            tmpbuffer<span class="token punctuation">[</span><span class="token punctuation">(</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// 回填L</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span>
        L<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> tmpbuffer<span class="token punctuation">[</span><span class="token punctuation">(</span>first<span class="token operator">++</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// first 为有序序列头指针</span>
    <span class="token function">free</span><span class="token punctuation">(</span>tmpbuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="希尔排序（Shell’s-Sort）"><a class="headerlink" href="#希尔排序（Shell’s-Sort）"></a>希尔排序（Shell’s Sort）</h2>
<h3 id="产生来源"><a class="headerlink" href="#产生来源"></a>产生来源</h3>
<p>根据之前对直接插入排序的分析可得，其时间复杂度为 O(n<sup>2</sup>)，而当待排序列 <strong>基本有序</strong> 时，排序效率会有很大提高，复杂度可提升至 O(n)；另一方面，当<strong>数量较小</strong>时，排序效率又会有很大提升。基于这两点考量，1959 年 Shell 提出了希尔排序，又称<strong>缩小增量排序</strong>（Diminshing Increment Sort）</p>
<h3 id="基本思想-v2"><a class="headerlink" href="#基本思想-v2"></a>基本思想</h3>
<p>先将待排序列<strong>按增量</strong>分割成若干元素数量相同的子序列，分别进行直接插入排序，（不断缩小增量）待整个序列“基本有序”时，再对全体序列进行一次直接插入排序（即增量缩小至1）。</p>
<p>具体地，</p>
<p>注意点：划分子序列不是简单地“连续逐段分割”，而是将<strong>相隔某增量的元素</strong>划分为一组；因此，排序过程中，元素的移动不是一步一步的移动，而是<strong>跳跃式的移动</strong>，而这种分组跳跃式移动也使得希尔排序是一种<strong>不稳定排序</strong>。</p>
<p>要点：<strong>增量的选择</strong> 和 <strong>排序最终以1为增量进行排序结束</strong>。</p>
<h3 id="代码实现-v2"><a class="headerlink" href="#代码实现-v2"></a>代码实现</h3>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">ShellSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> L<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">,</span> d<span class="token punctuation">;</span> <span class="token comment">// 增量</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>d <span class="token operator">=</span> n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> d <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">;</span> d <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">// 一趟插入排序，增量为 d，故需进行 d 组子序列排序</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> d<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token comment">// i 是每组子序列首元素</span>
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span><span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token operator">+</span>d<span class="token punctuation">;</span> j <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> j <span class="token operator">+=</span> d<span class="token punctuation">)</span> <span class="token comment">// 无序部分</span>
            <span class="token punctuation">&#123;</span>
                L<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// L[0] 仅用于暂存待插入元素</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token operator">=</span> j<span class="token operator">-</span>d<span class="token punctuation">;</span> k <span class="token operator">>=</span> i <span class="token operator">&amp;&amp;</span> L<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">></span> L<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> k <span class="token operator">-=</span>d<span class="token punctuation">)</span> <span class="token comment">// 在有序部分中找位置</span>
                    L<span class="token punctuation">[</span>k<span class="token operator">+</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
                L<span class="token punctuation">[</span>k<span class="token operator">+</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>上述代码，在进行一趟希尔排序时，是分成 d 组进行的，每组独立进行排序（L5-L7），可以将其合并，进行依次遍历即可，改进如下。</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">void</span> <span class="token function">ShellSort</span><span class="token punctuation">(</span><span class="token keyword">int</span> L<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> dk<span class="token punctuation">;</span> <span class="token comment">// 增量 dk</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>dk <span class="token operator">=</span> n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> dk <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">;</span> dk <span class="token operator">/=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 这里 dk序列取 n/2,n/4,...1</span>
    <span class="token punctuation">&#123;</span>
        <span class="token comment">// 一趟希尔插入排序</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">+</span>dk<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> n<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token comment">// L[1+dk,...n]</span>
        <span class="token punctuation">&#123;</span>
            L<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// L[0] 仅用于暂存待插入元素</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> i<span class="token operator">-</span>dk<span class="token punctuation">;</span> j <span class="token operator">>=</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> L<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">></span> L<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> j <span class="token operator">-=</span>dk<span class="token punctuation">)</span> <span class="token comment">// 在有序部分中找位置</span>
                L<span class="token punctuation">[</span>j<span class="token operator">+</span>dk<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            L<span class="token punctuation">[</span>j<span class="token operator">+</span>d<span class="token punctuation">]</span> <span class="token operator">=</span> L<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="归纳分析-v2"><a class="headerlink" href="#归纳分析-v2"></a>归纳分析</h3>
<ol>
<li>不稳定排序（unstable sort）</li>
</ol>
<p>分组跳跃式移动使得希尔排序是一种<strong>不稳定排序</strong>。</p>
<ol start="2">
<li>空间复杂度（in-place 原地算法，O(1)）</li>
</ol>
<p>需要 1 个辅助空间暂存元素，希尔排序的空间复杂度为 O(1)。</p>
<ol start="3">
<li>时间复杂度</li>
</ol>
<p>希尔排序的分析较复杂，其时间复杂度是依赖于“增量序列”的函数，涉及到一些数学上尚未解决的问题，目前尚未求得一种最好的增量序列。</p>
<p><strong>最坏</strong>情况下，希尔排序的时间复杂度为 O(n<sup>2</sup>)。</p>
<p>但大量的研究证明了一些局部结论，</p>
<p>当增量序列为 delta[k] = 2<sup>t-k+1</sup>-1 时，</p>
<p>希尔排序的时间复杂度为 O(n<sup>3/2</sup>)，其中 t 为排序趟数，1 ≤ k ≤ ⌊ log<sub>2</sub>(n+1) ⌋</p>
<p>也有从大量实验推导出，</p>
<p>当 n 在某个特定范围时，希尔排序的时间复杂度约为 O(n<sup>1.3</sup>)，当 n → ∞ 时，可提高到 O(n(log<sub>2</sub>n)<sup>2</sup>)。</p>
<p>注意：增量序列有很多种取法，但都需要使<strong>增量序列中的值没有除 1 外的公因子</strong>，并且<strong>最后一个增量必须为 1</strong>。</p>
<ol start="4">
<li>初态影响</li>
</ol>
<p>仍然是插入排序，受初始状态影响。</p>
<ol start="5">
<li>过程特征</li>
</ol>
<p>一趟排序不能确定一个元素的最终位置，也不会产生有序子序列。</p>
<ol start="6">
<li>适用性</li>
</ol>
<p>希尔排序是根据插入排序的适用性（比较适合用于“基本有序”的序列和“数据量不大”的序列）进行的相应优化。</p>
<p>由于是分组跳跃式比较移动，所以希尔排序仅适用于<strong>顺序存储</strong>的序列。</p>

          </div>
          <div class="post-footer">
            <div class="post-copyright">&copy; 除特殊声明外，文章著作权归作者所有，转载请注明作者及出处</div>
          </div>
        </article>
        <!-- Pagination -->
        
          <div class="nagination card">
            
              <a href="/Notes/archives/148ac2b25397" class="nagination-link">上篇: 插入排序（一）</a>
            
            
              <a href="/Notes/archives/33c96e729c04" class="nagination-link">下篇: 内部排序</a>
            
          </div>
        
        <!-- Comment -->
        <!-- 
          <div id="article-comment" class="article-comment card"></div>

         -->
      </div>
      <div id="toc" class="toc">
        
          <ol class="toc-content"><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#2-%E8%B7%AF%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F%EF%BC%882-Path-Insertion-Sort%EF%BC%89"><span class="toc-content-text">2-路插入排序（2-Path Insertion Sort）</span></a><ol class="toc-content-child"><li class="toc-content-item toc-content-level-3"><a class="toc-content-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3"><span class="toc-content-text">基本思想</span></a></li><li class="toc-content-item toc-content-level-3"><a class="toc-content-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-content-text">代码实现</span></a></li><li class="toc-content-item toc-content-level-3"><a class="toc-content-link" href="#%E5%BD%92%E7%BA%B3%E5%88%86%E6%9E%90"><span class="toc-content-text">归纳分析</span></a></li><li class="toc-content-item toc-content-level-3"><a class="toc-content-link" href="#%E6%89%A9%E5%B1%95"><span class="toc-content-text">扩展</span></a></li></ol></li><li class="toc-content-item toc-content-level-2"><a class="toc-content-link" href="#%E5%B8%8C%E5%B0%94%E6%8E%92%E5%BA%8F%EF%BC%88Shell%E2%80%99s-Sort%EF%BC%89"><span class="toc-content-text">希尔排序（Shell’s Sort）</span></a><ol class="toc-content-child"><li class="toc-content-item toc-content-level-3"><a class="toc-content-link" href="#%E4%BA%A7%E7%94%9F%E6%9D%A5%E6%BA%90"><span class="toc-content-text">产生来源</span></a></li><li class="toc-content-item toc-content-level-3"><a class="toc-content-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3-v2"><span class="toc-content-text">基本思想</span></a></li><li class="toc-content-item toc-content-level-3"><a class="toc-content-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0-v2"><span class="toc-content-text">代码实现</span></a></li><li class="toc-content-item toc-content-level-3"><a class="toc-content-link" href="#%E5%BD%92%E7%BA%B3%E5%88%86%E6%9E%90-v2"><span class="toc-content-text">归纳分析</span></a></li></ol></li></ol>
        
      </div>
    </section>


</div>
        <footer id="footer" class="footer">
  <div class="outer">
    <div class="copyright">
      <p><span>EXP Notes</span> &copy; 2015 - 2022</p>
    </div>
    <div class="navigation">
      <a href="https://evandoz.github.io">Hexo · Levan</a>
    </div>
  </div>
</footer>

      </div>
    </div>
  </div>
  
  <div id="mobile-nav" class="mobile-nav">
  
    <a class="menu-item" href="/Notes/archives">归档</a>
  
    <a class="menu-item" href="/Notes/categories">分类</a>
  
    <a class="menu-item" href="/Notes/tags">标签</a>
  
    <a class="menu-item" href="/Notes/about">关于</a>
  
</div>

<div id="over-layer" class="over-layer"></div>

  
<script src="/Notes/js/jquery.js"></script>


<script src="/Notes/js/velocity.js"></script>


<script src="/Notes/js/plugins.js"></script>


<script src="/Notes/js/script.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->




</body>
</html>
