<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>使用 DiskPart 自定义 Windows 分区类型及大小 | EXP Notes</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
    <meta name="author" content="Levan">
  
  
    <meta name="description" content="日常记录与分享">
  
  
    <meta name="keywords" content="DiskPart,Windows,自定义分区类型及大小">
  
  
    <meta name="google-site-verification" content="W2AVg5n_ALo21rl9n3ZwS8AuEanZfJkirzrRGLLYvn4">
  
  
    <meta name="baidu-site-verification" content="BM2Q3xLpPJ">
  
  
    <meta name="360-site-verification" content="573211edf2de02c99d7b255b2c56513c">
  
  
    <link rel="short icon" type="image/x-icon" href="/Notes/css/images/favicon.ico">
  
  <link rel="canonical" href="https://evandoz.github.io/Notes/archives/c1803dc071b8.html">
  
<link rel="stylesheet" href="/Notes/css/style.css">

<meta name="generator" content="Hexo 5.3.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="overflow" class="overflow">
    <div id="hiddenbar" class="hiddenbar">
      <div id="wrapper" class="wrapper">
        <header id="header" class="header is-post">
  <div class="outer">
    <div class="logo">
      <a class="title" href="/Notes/">EXP Notes</a>
    </div>
    <div class="nav">
      <ul id="nav-icon" class="nav-icon">
        <li></li><li></li><li></li>
      </ul>
      <ul class="nav-menu">
        
          <li class="nav-item">
            <a href="/Notes/archives">归档</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/categories">分类</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/tags">标签</a>
          </li>
        
          <li class="nav-item">
            <a href="/Notes/about">关于</a>
          </li>
        
      </ul>
    </div>

  </div>
</header>

        <div id="content" class="content">
    <section class="article-header inner">
      <img src="/Notes/css/images/banner2.jpg" alt="banner">
      

      
  
  	<h1 class="post-title">使用 DiskPart 自定义 Windows 分区类型及大小</h1>
  


      <div class="post-meta">
        <span class="post-date">
  <time datetime="2019-01-09T16:00:00.000Z">2019-01-10</time>
</span>

        
  <span class="post-category">
    <a class="category-link" href="/Notes/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a> · <a class="category-link" href="/Notes/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/Windows/">Windows</a>
  </span>


      </div>
    </section>
    <section class="article-body inner">
      <div id="side" class="aside post left">

      </div>
      <div class="main">
        <article id="操作系统/Windows/20190110-使用 DiskPart 自定义 Windows 分区类型及大小" class="article">
          <div id="post-content" class="post-content">
            <p>使用优启安装 Windows 时，创建系统引导分区一般有两种方法：</p>
<ol>
<li>从优盘启动后，直接使用 Windows 的自动创建功能，它默认会创建相应大小的分区，其大小一般如下（Windows 10）</li>
</ol>
<pre class="line-numbers language-none"><code class="language-none">分区 ###       类型              大小     偏移量
-------------  ----------------  -------  -------
分区      1    恢复                 529 MB  1024 KB
分区      2    系统                 100 MB   530 MB
分区      3    保留                  16 MB   630 MB
分区      4    主要                  XX GB   646 MB
......<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>恢复（Recovery）分区</strong>：用于 Windows Recovery，默认大小为 529M，安装好系统后会使用掉 465M 左右，剩余空间 16% 。默认大小有个痛点就是，Windows 10 大版本直接通过系统更新时会出现空间不足，然后它就会从系统盘（C:）扣除，这样一来已经调整好的分区空间就会被破坏（强迫症），当然如果自己下载系统重装就不会出现这种情况了。</p>
<p><strong>系统（EFI System）分区</strong>：引导分区，非常重要，缺失将无法进入系统，默认大小 100M，用于存放引导文件，当系统本身完好，引导出问题时，可以通过优启打开 CMD 终端，通过 bcdboot 重建引导分区。100M 的默认大小对于安装双系统会是一个痛点，像 Linux、MacOS 一般要求 200M+，如黑苹果双系统，若 ESP 分区小于 200M，MacOS 上如磁盘工具等会无法使用。</p>
<p><strong>保留（MSR）分区</strong>：未分配分区，默认大小 16M，不是很重要，可有可无。</p>
<p><strong>主要（Primary）分区</strong>：安装系统、软件的分区，即实际可以被掌控的分区（C:、D:、E:…）。</p>
<ol start="2">
<li>使用 Windows 自带的 DiskPart 命令行工具手动分配</li>
</ol>
<p>优盘启动至选择分区时，Shift + F10 打开 CMD 终端，使用命令</p>
<pre class="line-numbers language-none"><code class="language-none">diskpart<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>即可进入分区工具终端操作界面（大小写不敏感）</p>
<p>显示所有硬盘</p>
<pre class="line-numbers language-none"><code class="language-none">list disk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>选择硬盘</p>
<pre class="line-numbers language-none"><code class="language-none">select disk X （X为硬盘编号）<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>清空磁盘</p>
<pre class="line-numbers language-none"><code class="language-none">clean<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>转化为 GPT 分区表</p>
<pre class="line-numbers language-none"><code class="language-none">convert gpt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><strong>创建恢复分区</strong></p>
<pre class="line-numbers language-none"><code class="language-none">cre part primary size&#x3D;512
format quick fs&#x3D;ntfs label&#x3D;&quot;Recovery&quot; （fs&#x3D;filesystem，格式化为 NTFS）
set id&#x3D;&quot;de94bba4-06d1-4d40-a16a-bfd50179d6ac&quot;  （设置GUID，表示 GPT 分区类型）
gpt attributes&#x3D;0x8000000000000001  （设置Attribute，表示 GPT 分区属性，此处为其设置特殊保护）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>创建系统分区</strong></p>
<pre class="line-numbers language-none"><code class="language-none">cre part efi size&#x3D;256  （建议 256M - 512M，如果装双系统建议设置大一点）
format quick fs&#x3D;fat32 （fs&#x3D;filesystem，格式化为 FAT32）
set id&#x3D;&quot;c12a7328-f81f-11d2-ba4b-00a0c93ec93b&quot;  （设置GUID，表示 GPT 分区类型）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>创建保留分区</strong></p>
<pre class="line-numbers language-none"><code class="language-none">cre part msr size&#x3D;16 （使用 Windows 10 默认大小）
&#x2F;&#x2F; set id&#x3D;&quot;e3c9e316-0b5c-4db8-817d-f92df00215ae&quot;  （设置GUID，表示 GPT 分区类型，Windows MSR 分区不支持此操作）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>注：MSR 分区未格式化，因为它的设定就是未分配空间。</p>
<p>以上命令中使用了简写：</p>
<p>cre === create<br>
part === partition</p>
<p>使用命令</p>
<pre class="line-numbers language-none"><code class="language-none">list part<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>显示刚创建的分区：</p>
<pre class="line-numbers language-none"><code class="language-none">分区 ###       类型              大小     偏移量
-------------  ----------------  -------  -------
分区      1    恢复                 512 MB  1024 KB
分区      2    系统                 256 MB   513 MB
分区      3    保留                  16 MB   769 MB
分区      4    主要                  50 GB   785 MB<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>最后，关于 GPT 分区表的内容参见</p>

          </div>
          <div class="post-footer">
            <div class="post-copyright">&copy; 除特殊声明外，文章著作权归作者所有，转载请注明作者及出处</div>
          </div>
        </article>
        <!-- Pagination -->
        
          <div class="nagination card">
            
              <a href="/Notes/archives/b1f0f966d5c6" class="nagination-link">上篇: GPT 分区表</a>
            
            
              <a href="/Notes/archives/ee4964119549" class="nagination-link">下篇: 在 ArchLinux 中使用 Secure Boot</a>
            
          </div>
        
        <!-- Comment -->
        <!-- 
          <div id="article-comment" class="article-comment card"></div>

         -->
      </div>
      <div id="toc" class="toc">
        
          <li class="toc-title" style="text-align: center;"></li>
        
      </div>
    </section>


</div>
        <footer id="footer" class="footer">
  <div class="outer">
    <div class="copyright">
      <p><span>EXP Notes</span> &copy; 2015 - 2022</p>
    </div>
    <div class="navigation">
      <a href="https://evandoz.github.io">Hexo · Levan</a>
    </div>
  </div>
</footer>

      </div>
    </div>
  </div>
  
  <div id="mobile-nav" class="mobile-nav">
  
    <a class="menu-item" href="/Notes/archives">归档</a>
  
    <a class="menu-item" href="/Notes/categories">分类</a>
  
    <a class="menu-item" href="/Notes/tags">标签</a>
  
    <a class="menu-item" href="/Notes/about">关于</a>
  
</div>

<div id="over-layer" class="over-layer"></div>

  
<script src="/Notes/js/jquery.js"></script>


<script src="/Notes/js/velocity.js"></script>


<script src="/Notes/js/plugins.js"></script>


<script src="/Notes/js/script.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->




</body>
</html>
