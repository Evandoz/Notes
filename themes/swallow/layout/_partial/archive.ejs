<div class="archive"> 
  <% if (pagination == 2){ %>
    <% page.posts.forEach(function(post){ %>
      <%- partial('_partial/article', {post: post, index: true}) %>
    <% }) %>
  <% } else { %>
    <% if (is_archive()) { %>
      <% var last, year; %>
      <% page.posts.each(function(post, i){ %>
        <% year = post.date.year(); %>
        <% if (last != year){ %>
          <% if (last != null){ %>
          </div>
          <% } %>
          <% last = year; %>
          <% if (is_year()) { %>
            <h1 class="archive-year"><%= year %></h1>
          <% } else { %>
            <h1><a class="archive-year" href="<%- url_for(config.archive_dir + '/' + year) %>"><%= year %></a></h1>
          <% } %>
          <div class="archive-list">
        <% } %>
        <%- partial('archive-post', {post: post, even: i % 2 == 0}) %>
      <% }) %>
      <% if (page.posts.length){ %>
      </div>
      <% } %>
    <% } else { %>
      <h1 class="archive-year"><%= title %></h1>
      <div class="archive-list">
        <% page.posts.each(function(post, i){ %>
          <%- partial('archive-post', {post: post, even: i % 2 == 0}) %>
        <% }) %>
        </div>
    <% } %>
  <% } %>
</div>
<%- partial('_partial/paginator') %>